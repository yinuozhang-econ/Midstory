-----------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/yinuozhang/Dropbox/Personal/Midstory/rustBelt/stata/cleaning.log
  log type:  text
 opened on:  17 Jul 2022, 12:56:00

. cd "$work"
/Users/yinuozhang/Dropbox/Personal/Midstory/rustBelt/stata

. use "$work/cleaning.dta", clear

. 
. desc

Contains data from /Users/yinuozhang/Dropbox/Personal/Midstory/rustBelt/stata/cleaning.dta
  obs:     6,771,228                          
 vars:            16                          16 Jul 2022 18:00
 size:   406,273,680                          
-----------------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
-----------------------------------------------------------------------------------------------------
year            int     %8.0g      year_lbl   Census year
sample          long    %40.0g     sample_lbl
                                              IPUMS sample identifier
serial          double  %8.0f                 Household serial number
hhwt            double  %10.2f                Household weight
cluster         double  %13.0f                Household cluster for variance estimation
statefip        byte    %57.0g     statefip_lbl
                                              State (FIPS code)
strata          double  %12.0f                Household strata for variance estimation
gq              byte    %43.0g     gq_lbl     Group quarters status
pernum          int     %8.0g                 Person number in sample unit
perwt           double  %10.2f                Person weight
empstat         byte    %18.0g     empstat_lbl
                                              Employment status [general version]
empstatd        byte    %38.0g     empstatd_lbl
                                              Employment status [detailed version]
labforce        byte    %26.0g     labforce_lbl
                                              Labor force status
ind1990         int     %62.0g     ind1990_lbl
                                              Industry, 1990 basis
wkswork1        byte    %8.0g                 Weeks worked last year
incwage         long    %12.0g                Wage and salary income
-----------------------------------------------------------------------------------------------------
Sorted by: 

. 
. do selectVar.do

. *******************************************************************
. * Keep only private sector workers
. * From Alder etal 21
. *******************************************************************
. 
. *******************************************************************
. * identify manufacture workers
. *******************************************************************
. * mining + construction + nondurable manufacture + durable manufacture
. gen manu = 0

. replace manu = 1 if (ind1990 >= 40) & (ind1990 <= 350)
(802,464 real changes made)

. 
. *******************************************************************
. * Feryer etal: primary metals (33) and transportation (37), respec- tively. The bulk of the employm
> ent in these SICs falls within the steel and auto industries, as seen by looking at the four-digit 
> industries within SICs 33 and 37, which are summarized in appendix A.
. * SIC 33: as late as 1993, 70 per- cent of total employment was within steel and iron foundries, st
> eel rolling mills, and steel and iron pipe factories.
. * SIC 37: the bulk of employment was directly in the production of cars, trucks, buses, and motor h
> omes.
. *******************************************************************
. * gen nondurb = 0
. /* replace manu = 1 if (ind1990 == 270) | /// * Blast furnaces, steelworks, rolling and finishing m
> ills
> (ind1990 == 271) | /// * Iron and steel foundries
> (ind1990 == 272) | /// * primary aluminum industries
> (ind1990 == 280) | /// * Other primary metal industries
> (ind1990 == 281) | /// * Cutlery, handtools, and general hardware
> (ind1990 == 282) | /// * Fabricated structural metal products
> (ind1990 == 291) | /// * Metal forgings and stampings
> (ind1990 == 292) | /// * Ordnance
> (ind1990 == 300) | /// * Misc fabricated metal products
> (ind1990 == 301)  /* Metal industries, n.s.*/
> */
. 
. * nondurable + mining + construction
. * replace nondurb = 1 if (ind1990 >= 40) & (ind1990<= 222)
. 
. * gen durb = 0
. /* replace equip = 1 if (ind1990 == 310) | /// * Engines and turbines
> (ind1990 == 311) | /// * Farm machinery and equipment
> (ind1990 == 312) | /// * Construction and material handling machines
> (ind1990 == 320) | /// * Metalworking machineary
> (ind1990 == 351) | /// * Motor vehicles and motor vehicle equipment
> (ind1990 == 361)  /* Railroad locomotives and equipment */
> */
. 
. * durable
. * replace durb = 1 if (ind1990 >=230) & (ind1990 <= 350)
. * “Mining” or “Extractive industries” or “Manufacturing” or “Construction”. From growth and structu
> ral transformation handbook chapter, Appendix A on sector assignments
. *******************************************************************
. * identify rustbelt region
. * Indiana, Illinois, Michigan, New York, Ohio, Wisconsin, Pennsylvania, and West Virginia
. * Definition coming from Alder etal 21
. *******************************************************************
. gen rb = 0

. replace rb = 1 if (statefip == 17 ) | /// * Indiana
> (statefip == 18) | /// * Illinois
> (statefip == 26) | /// * Michigan
> (statefip == 36) | /// * New York
> (statefip == 39) | /// * Ohio
> (statefip == 55) | /// * Wisconsin
> (statefip == 42) | /// * Pennsylvania
> (statefip == 54) /* West Virginia */
(2,220,274 real changes made)

. 
. * drop
. drop if (empstatd == 0) | /// * N/A
> (empstatd == 13) | /// * Armed forces
> (empstatd == 14) | /// * Armed forces--at work
> (empstatd == 15) /* Armed forces--not at work but with job */
(1,858,353 observations deleted)

. gen empl = 0

. replace empl = 1 if empstat == 1
(2,702,004 real changes made)

. 
. 
. * collapse by perwt
. collapse (sum) perwt, by(year rb manu empstat)

. 
end of do-file

. 
. gsort year empstat manu rb

. * only keeping the employeed

. keep if empstat == 1
(24 observations deleted)

. 
. bysort year: egen totalEmp = total(perwt)

. bysort year rb: egen rb_totalEmp = total(perwt) if rb == 1
(6 missing values generated)

. gsort year -rb

. bysort year: replace rb_totalEmp = rb_totalEmp[_n-1] if missing(rb_totalEmp)
(6 real changes made)

. 
. bysort year manu: egen manu_totalEmp = total(perwt) if manu == 1
(6 missing values generated)

. gsort year -manu

. bysort year: replace manu_totalEmp = manu_totalEmp[_n-1] if missing(manu_totalEmp)
(6 real changes made)

. 
. gen manu_rb_totalEmp = perwt if rb == 1 & manu == 1
(9 missing values generated)

. gsort year -manu -rb

. bysort year: replace manu_rb_totalEmp = manu_rb_totalEmp[_n-1] if missing(manu_rb_totalEmp)
(9 real changes made)

. 
. drop empstat manu rb perwt

. duplicates drop

Duplicates in terms of all variables

(9 observations deleted)

. 
. * nationalRate rustbeltRate

. gen nationalRate = manu_totalEmp/totalEmp

. gen rustBeltRate = manu_rb_totalEmp/manu_totalEmp

. tab year nationalRate

    Census |           nationalRate
      year |  .1860656   .2667235   .3020383 |     Total
-----------+---------------------------------+----------
      1950 |         0          0          1 |         1 
      1970 |         0          1          0 |         1 
      2000 |         1          0          0 |         1 
-----------+---------------------------------+----------
     Total |         1          1          1 |         3 


. tab year rustBeltRate

    Census |           rustBeltRate
      year |  .2906996   .3951572   .4583887 |     Total
-----------+---------------------------------+----------
      1950 |         0          0          1 |         1 
      1970 |         0          1          0 |         1 
      2000 |         1          0          0 |         1 
-----------+---------------------------------+----------
     Total |         1          1          1 |         3 


. 
. outsheet using "$work/output.csv", comma replace

. 
. log close
      name:  <unnamed>
       log:  /Users/yinuozhang/Dropbox/Personal/Midstory/rustBelt/stata/cleaning.log
  log type:  text
 closed on:  17 Jul 2022, 12:56:07
-----------------------------------------------------------------------------------------------------

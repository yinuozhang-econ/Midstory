------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/yinuozhang/Dropbox/Personal/Midstory/rust belt/stata/cleaning.log
  log type:  text
 opened on:  16 Jul 2022, 13:23:10

. cd "$work"
/Users/yinuozhang/Dropbox/Personal/Midstory/rust belt/stata

. use "$work/cleaning.dta", clear

. 
. desc

Contains data from /Users/yinuozhang/Dropbox/Personal/Midstory/rust belt/stata/cleaning.dta
  obs:     6,771,228                          
 vars:            16                          15 Jul 2022 22:23
 size:   406,273,680                          
------------------------------------------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
------------------------------------------------------------------------------------------------------------------------------
year            int     %8.0g      year_lbl   Census year
sample          long    %40.0g     sample_lbl
                                              IPUMS sample identifier
serial          double  %8.0f                 Household serial number
hhwt            double  %10.2f                Household weight
cluster         double  %13.0f                Household cluster for variance estimation
statefip        byte    %57.0g     statefip_lbl
                                              State (FIPS code)
strata          double  %12.0f                Household strata for variance estimation
gq              byte    %43.0g     gq_lbl     Group quarters status
pernum          int     %8.0g                 Person number in sample unit
perwt           double  %10.2f                Person weight
empstat         byte    %18.0g     empstat_lbl
                                              Employment status [general version]
empstatd        byte    %38.0g     empstatd_lbl
                                              Employment status [detailed version]
labforce        byte    %26.0g     labforce_lbl
                                              Labor force status
ind1990         int     %62.0g     ind1990_lbl
                                              Industry, 1990 basis
wkswork1        byte    %8.0g                 Weeks worked last year
incwage         long    %12.0g                Wage and salary income
------------------------------------------------------------------------------------------------------------------------------
Sorted by: 

. 
. *******************************************************************

. * Keep only private sector workers

. * From Alder etal 21

. *******************************************************************

. 
. *******************************************************************

. * identify manufacture workers

. *******************************************************************

. * Feryer etal: primary metals (33) and transportation (37), respec- tively. The bulk of the employment in these SICs falls w
> ithin the steel and auto industries, as seen by looking at the four-digit industries within SICs 33 and 37, which are summar
> ized in appendix A.

. * SIC 33: as late as 1993, 70 per- cent of total employment was within steel and iron foundries, steel rolling mills, and st
> eel and iron pipe factories.

. * SIC 37: the bulk of employment was directly in the production of cars, trucks, buses, and motor homes.

. *******************************************************************

. gen manu = 0

. 
. */

. 
. * nondurable

. replace manu = 1 if (ind1990 >= 100) & (ind1990<= 222)
(283,485 real changes made)

. 
. gen equip = 0

. 
. */

. 
. * durable

. replace equip = 1 if (ind1990 >=230) & (ind1990 <= 350)
(273,426 real changes made)

. *******************************************************************

. * identify rustbelt region

. * Indiana, Illinois, Michigan, New York, Ohio, Wisconsin, Pennsylvania, and West Virginia

. * Definition coming from Alder etal 21

. *******************************************************************

. gen rb = 0

. replace rb = 1 if (statefip == 17 ) | (statefip == 18) | (statefip == 26) | (statefip == 36) | (statefip == 39) | (statefip 
> == 55) | (statefip == 42) | (statefip == 54) 
(2,220,274 real changes made)

. 
. * drop

. drop if (empstatd == 0) | (empstatd == 13) | (empstatd == 14) | (empstatd == 15) 
(1,858,353 observations deleted)

. gen empl = 0

. replace empl = 1 if empstat == 1
(2,702,004 real changes made)

. 
. 
. * collapse by perwt

. collapse (sum) perwt, by(year rb manu equip empstat)

. gsort year empstat manu equip rb

. drop if (empstat != 1) & (manu!= 0 | equip!= 0)
(24 observations deleted)

. * bysort year: egen pop_national = total(perwt)

. * bysort year rb: egen pop_total = total(perwt)

. bysort year empstat: egen pop_by_empstat = total(perwt)

. bysort year empstat rb: egen pop_by_empstat_rb = total(perwt)

. 
. gen pop_manu = perwt if manu == 1
(24 missing values generated)

. bysort year rb: egen pop_manu_and_equip = total(perwt) if (manu == 1 | equip == 1)
(18 missing values generated)

. 
. drop perwt equip

. 
. * only keep the sector specifics numbers to empstat == 1

. gsort year rb empstat pop_manu

. bysort year rb: replace pop_manu = pop_manu[_n-1] if empstat == 1 & missing(pop_manu)
(12 real changes made)

. replace pop_manu = 0 if missing(pop_manu)
(12 real changes made)

. 
. gsort year rb empstat pop_manu_and_equip

. bysort year rb: replace pop_manu_and_equip = pop_manu_and_equip[_n-1] if empstat == 1 & missing(pop_manu_and_equip)
(6 real changes made)

. replace pop_manu_and_equip = 0 if missing(pop_manu_and_equip)
(12 real changes made)

. duplicates drop

Duplicates in terms of all variables

(6 observations deleted)

. gsort year rb empstat

. order year rb empstat manu

. 
. reshape wide pop*, i(year rb empstat) j(manu)
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       24   ->      18
Number of variables                   8   ->      11
j variable (2 values)              manu   ->   (dropped)
xij variables:
                         pop_by_empstat   ->   pop_by_empstat0 pop_by_empstat1
                      pop_by_empstat_rb   ->   pop_by_empstat_rb0 pop_by_empstat_rb1
                               pop_manu   ->   pop_manu0 pop_manu1
                     pop_manu_and_equip   ->   pop_manu_and_equip0 pop_manu_and_equip1
-----------------------------------------------------------------------------

. drop *1

. * rename (pop_national0 pop_total0 pop_by_empstat0 pop_manu0 pop_manu_and_equip0) (pop_national pop_total pop_by_empstat pop
> _manu pop_manu_and_equip)

. rename ( pop_by_empstat0 pop_by_empstat_rb0 pop_manu0 pop_manu_and_equip0) ( pop_by_empstat pop_by_empstat_rb  pop_manu pop_
> manu_and_equip)

. 
. drop if empstat != 1
(12 observations deleted)

. bysort year: egen pop_manu_national = total(pop_manu)

. bysort year: egen pop_manu_equip_national = total(pop_manu_and_equip)

. gen manu_r_nation = pop_manu_national/pop_by_empstat

. gen manu_equip_r_nation = pop_manu_equip_national/pop_by_empstat

. 
. gen manu_r_rb = pop_manu/pop_by_empstat_rb if rb == 1
(3 missing values generated)

. gen manu_equip_r_rb = pop_manu_and_equip/pop_by_empstat_rb if rb == 1
(3 missing values generated)

. 
. log close
      name:  <unnamed>
       log:  /Users/yinuozhang/Dropbox/Personal/Midstory/rust belt/stata/cleaning.log
  log type:  text
 closed on:  16 Jul 2022, 13:23:23
------------------------------------------------------------------------------------------------------------------------------
